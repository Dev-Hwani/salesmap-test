# 사용 설명서

이 문서는 현재 구현된 Salesmap 과제 프로젝트의 실제 사용 흐름을 기준으로 작성되었습니다.

## 1) 실행 준비

### 환경 변수

`.env`

```
DATABASE_URL="mysql://root:1234@localhost:3306/salesmap_test"
JWT_SECRET="salesmap-secret-please-change-1234567890"
JWT_EXPIRES_IN="7d"
```

### DB 준비

```
pnpm db:migrate
pnpm db:seed
```

### 개발 서버 실행

```
pnpm dev
```

접속: `http://localhost:3000`

---

## 2) 회원가입 / 로그인

### 회원가입

1. `/signup` 접속
2. 이름/이메일/비밀번호 입력
3. 처음 가입자는 자동으로 A 역할로 생성됨
4. 두 번째 이후 가입자는 역할 선택 가능
   - B는 A를 매니저로 선택
   - C는 B를 매니저로 선택
5. 가입 완료 시 `/pipeline`으로 이동

### 로그인

1. `/login` 접속
2. 이메일/비밀번호 입력
3. 성공 시 `/pipeline` 이동

### 로그아웃

- 상단 메뉴의 로그아웃 버튼 클릭

---

## 3) 딜 파이프라인 (칸반)

### 파이프라인 선택

- 상단 “파이프라인” 드롭다운에서 선택

### 딜 생성

1. “딜 생성” 버튼 클릭
2. 기본 필드 입력
   - 딜 이름
   - 예상 매출
   - 마감일
3. 커스텀 필드는 `생성 화면 표시`가 켜진 항목만 노출
4. 저장 시 칸반에 즉시 반영

### 딜 이동

- 카드 Drag & Drop으로 스테이지 이동

---

## 4) 필터

1. 필터 조건 추가
2. 필드 선택 (기본 + 커스텀)
3. 연산자 선택: `is`, `is not`
4. 값 입력
5. 여러 조건은 AND로 결합

---

## 5) 리드/고객/회사 관리

경로: `/leads`, `/contacts`, `/companies`

### 목록 확인

- 각 오브젝트 목록이 카드 형태로 표시됩니다.
- 표시 항목은 시스템 필드 + `목록 표시`가 켜진 커스텀 필드입니다.

### 생성

1. 상단 “생성” 버튼 클릭
2. 시스템 필드 + `생성 화면 표시` 커스텀 필드 입력
3. 저장 시 목록에 즉시 반영

### 수정/삭제

- 목록 카드의 “수정” 버튼으로 값 수정
- “삭제”는 soft delete 방식으로 처리됨

---

## 6) 파이프라인 / 스테이지 관리

경로: `/settings/pipelines`

### 파이프라인

- 생성 / 수정 / 삭제 가능
- 삭제 조건
  - 딜이 있는 파이프라인은 삭제 불가
  - 최소 1개 유지

### 스테이지

- 생성 / 수정 / 순서 변경 가능
- 필드
  - 이름 / 가능성 / 설명 / 정체 기준일
- 삭제 조건
  - 딜이 존재하면 삭제 불가
  - 최소 3개 유지

---

## 7) 커스텀 필드 관리

경로: `/settings/fields`

### 필드 타입

- text
- number
- date
- datetime

### 옵션

- 생성 화면 표시 (visible_in_create)
- 파이프라인/목록 표시 (visible_in_pipeline)
- 필수 필드
- 데이터 마스킹

### 제한

- 값이 있는 필드는 타입 변경 불가
- 데이터 마스킹 옵션은 수정 불가
- 마스킹 필드는 검색/필터에 사용되지 않음

---

## 8) 권한 규칙 (A/B/C)

- A: A/B/C 딜 조회 가능
- B: B/C 딜 조회 가능
- C: 본인 딜만 조회 가능

권한은 칸반, 필터, 딜 수정에 모두 동일하게 적용됨

---

## 9) 주요 페이지

- `/login`: 로그인
- `/signup`: 회원가입
- `/pipeline`: 딜 파이프라인(칸반)
- `/leads`: 리드
- `/contacts`: 고객
- `/companies`: 회사
- `/settings/pipelines`: 파이프라인/스테이지 설정
- `/settings/fields`: 커스텀 필드 설정
